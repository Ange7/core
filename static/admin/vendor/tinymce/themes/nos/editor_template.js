(function(e){var d=e.DOM,b=e.dom.Event,h=e.extend,f=e.each,a=e.util.Cookie,g,c=e.explode;e.ThemeManager.requireLangPack("nos");e.create("tinymce.themes.NosTheme",{sizes:[8,10,12,14,18,24,36],controls:{bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],bullist:["bullist_desc","InsertUnorderedList"],numlist:["numlist_desc","InsertOrderedList"],outdent:["outdent_desc","Outdent"],indent:["indent_desc","Indent"],cut:["cut_desc","nosCut"],copy:["copy_desc","nosCopy"],paste:["paste_desc","nosPaste"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","RemoveFormat"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],charmap:["charmap_desc","mceCharMap"],anchor:["anchor_desc","mceInsertAnchor"],newdocument:["newdocument_desc","mceNewDocument"],blockquote:["blockquote_desc","mceBlockQuote"],brclearall:["brclearall_desc","nosBrClearAll"],image:["image_title","nosImage",null,null,"image_label"]},stateControls:["bold","italic","underline","strikethrough","bullist","numlist","sub","sup","blockquote"],init:function(k,m){var n=this,p,j,q;n.editor=k;n.url=m;n.onResolveName=new e.util.Dispatcher(this);n.settings=p=h({theme_nos_path:true,theme_nos_toolbar_location:"external",theme_nos_toolbar_align:"left",theme_nos_statusbar_location:"bottom",theme_nos_buttons1:"tablecontrols",theme_nos_buttons2:"underline,strikethrough,sub,sup,|,forecolor,backcolor,|,outdent,indent,blockquote,|,anchor,charmap,hr,nonbreaking,brclearall,|,styleprops,removeformat",theme_nos_buttons3:"search,replace,|,spellchecker,|,newdocument,visualhtmlcontrols,code",theme_nos_buttons4:"image,nosmedia,linkcontrols,enhancer",theme_nos_buttons5:"styleselect,bold,italic,justifycontrols,bullist,numlist,|,cut,copy,pastecontrols,undo,redo,|,toolbar_toggle",theme_nos_style_formats:[{block:"p",title:"nos.paragraph"},{block:"address",title:"nos.address"},{block:"pre",title:"nos.pre"},{block:"h1",title:"nos.h1"},{block:"h2",title:"nos.h2"},{block:"h3",title:"nos.h3"},{block:"h4",title:"nos.h4"},{block:"h5",title:"nos.h5"},{block:"h6",title:"nos.h6"},{block:"div",title:"nos.div"},{block:"blockquote",title:"nos.blockquote"},{block:"code",title:"nos.code"},{block:"dt",title:"nos.dt"},{block:"dd",title:"nos.dd"},{block:"samp",title:"nos.samp"}],theme_nos_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_nos_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_nos_more_colors:1,theme_nos_row_height:23,theme_nos_resize_horizontal:1,theme_nos_resizing_use_cookie:1,theme_nos_font_sizes:"1,2,3,4,5,6,7",theme_nos_font_selector:"span",theme_nos_show_current_color:0,theme_nos_enhancers:[],readonly:k.settings.readonly},k.settings);if(!p.font_size_style_values){p.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt"}if(e.is(p.theme_nos_font_sizes,"string")){p.font_size_style_values=e.explode(p.font_size_style_values);p.font_size_classes=e.explode(p.font_size_classes||"");q={};k.settings.theme_nos_font_sizes=p.theme_nos_font_sizes;f(k.getParam("theme_nos_font_sizes","","hash"),function(s,r){var o;if(r==s&&s>=1&&s<=7){r=s+" ("+n.sizes[s-1]+"pt)";o=p.font_size_classes[s-1];s=p.font_size_style_values[s-1]||(n.sizes[s-1]+"pt")}if(/^\s*\./.test(s)){o=s.replace(/\./g,"")}q[r]=o?{"class":o}:{fontSize:s}});p.theme_nos_font_sizes=q}if((j=p.theme_nos_path_location)&&j!="none"){p.theme_nos_statusbar_location=p.theme_nos_path_location}if(p.theme_nos_statusbar_location=="none"){p.theme_nos_statusbar_location=0}if(k.settings.content_css!==false){k.contentCSS.push(k.baseURI.toAbsolute(m+"/skins/"+k.settings.skin+"/content.css"))}k.onInit.add(function(){if(!k.settings.readonly){k.onNodeChange.add(n._nodeChanged,n);k.onKeyUp.add(n._updateUndoStatus,n);k.onMouseUp.add(n._updateUndoStatus,n);k.dom.bind(k.dom.getRoot(),"dragend",function(){n._updateUndoStatus(k)})}});var i=this;k.addButton("nosmedia",{title:"nos.media_title",label:"nos.media_label","class":"mce_media",cmd:"mceMedia"});function l(o){var r=$(o.getBody());r.find(".nosEnhancer, .nosEnhancerInline").each(function(){var s=$(this);s.html("Loading...");var v=$(this).data("enhancer");var t=i.settings.theme_nos_enhancers[v];var u=$(this).data("config");$.ajax({url:t.previewUrl,type:"POST",dataType:"json",data:u,success:function(w){s.html(w.preview);i.onEnhancerAdd(s,t)},error:function(){s.html("Error when loading the preview of the application")}})})}k.onGetContent.add(function(r,t){var s=$(t.content);s.filter(".nosEnhancer, .nosEnhancerInline").empty();s.find(".nosEnhancer, .nosEnhancerInline").empty();t.content=$("<div></div>").append(s).html()});k.onSetContent.add(function(r,t){var s=$(t.content);s.find("img").filter(function(){return $(this).data("media-id")}).addClass("nosMedia");t.content=$("<div></div>").append(s).html();setTimeout(function(){l(r)},1)});k.onSaveContent.add(function(r,t){var s=$(t.content);s.find("img.nosMedia").replaceWith(function(){var o=$(this);var u=o.data("media");var v="nos://media/";if(u&&u.id){v+=u.id}else{v+=o.data("media-id")}if(o.attr("width")&&o.attr("height")){v+="/"+o.attr("width")+"/"+o.attr("height")}return $("<img />").attr({src:v,title:o.attr("title"),alt:o.attr("alt"),style:o.attr("style")})});t.content=$("<div></div>").append(s).html()});k.onClick.add(function(o,w){var v=$(w.target);var t=v.data("action");var u=null;if(t=="addParagraphBefore"){u=$("<p>New paragraph</p>");v.closest(".nosEnhancer, .nosEnhancerInline").before(u);o.selection.select(u.get(0),true);o.focus(false);o.execCommand("mceSelectNode",false,u.get(0),{skip_undo:1});o.execCommand("mceEndUndoLevel");w.preventDefault()}if(t=="addParagraphAfter"){u=$("<p>New paragraph</p>");v.closest(".nosEnhancer, .nosEnhancerInline").after(u);o.selection.select(u.get(0),true);o.focus(false);o.execCommand("mceSelectNode",false,u.get(0),{skip_undo:1});o.execCommand("mceEndUndoLevel");w.preventDefault()}if(t=="editEnhancer"){var r=v.closest(".nosEnhancer, .nosEnhancerInline");var s=i.settings.theme_nos_enhancers[$(r).data("enhancer")];i._nosEnhancer(null,s,r);w.preventDefault()}if(t=="removeEnhancer"){v.closest(".nosEnhancer, .nosEnhancerInline").remove();o.execCommand("mceEndUndoLevel");w.preventDefault()}});k.onSetProgressState.add(function(s,o,t){var u,v=s.id,r;if(o){n.progressTimer=setTimeout(function(){u=s.getContainer();u=u.insertBefore(d.create("DIV",{style:"position:relative"}),u.firstChild);r=d.get(s.id+"_tbl");d.add(u,"div",{id:v+"_blocker","class":"mceBlocker",style:{width:r.clientWidth+2,height:r.clientHeight+2}});d.add(u,"div",{id:v+"_progress","class":"mceProgress",style:{left:r.clientWidth/2,top:r.clientHeight/2}})},t||0)}else{d.remove(v+"_blocker");d.remove(v+"_progress");clearTimeout(n.progressTimer)}});d.loadCSS(p.editor_css?k.documentBaseURI.toAbsolute(p.editor_css):m+"/skins/"+k.settings.skin+"/ui.css");if(p.skin_variant){d.loadCSS(m+"/skins/"+k.settings.skin+"/ui_"+p.skin_variant+".css")}},createControl:function(l,i){var j,k;if(k=i.createControl(l)){return k}switch(l){case"enhancer":return this._createEnhancer();case"linkcontrols":return this._createLink();case"justifycontrols":return this._createJustify();case"file":return this._createFileButton();case"pastecontrols":return this._createPaste();case"toolbar_toggle":return this._createToolbarToggle();case"visualhtmlcontrols":return this._createVisualHtml();case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu()}if((j=this.controls[l])){return i.createButton(l,{title:"nos."+j[0],cmd:j[1],ui:j[2],value:j[3],label:j[4]?"nos."+j[4]:""})}},execCommand:function(m,l,n){var k=this["_"+m],i=this.editor;switch(m){case"nosCut":case"nosCopy":case"nosPaste":i.windowManager.alert(i.getLang("nos.clipboard_msg"));try{i.getDoc().execCommand(m.replace("nos",""),l,n)}catch(j){if(this.isGecko){i.windowManager.alert(i.getLang("nos.clipboard_msg"))}else{i.windowManager.alert(i.getLang("clipboard_no_support"))}}return true;break;default:if(k){k.call(this,l,n);return true}}return false},_createLink:function(){var m,j=this,k=j.settings,l={},i;m=j.editor.controlManager.createSplitButton("linkcontrols",{title:"nos.link_title",label:"nos.link_label",onclick:function(){j.editor.execCommand("mceLink",true,"")},"class":"mce_link"},e.ui.NosSplitButton);m.onRenderMenu.add(function(o,n){n.add({title:"nos.link_title","class":"mceMenuItemTitle"}).setDisabled(1);n.add({title:"nos.link_title",icon:"link",onclick:function(){j.editor.execCommand("mceLink",true,"")},id:"link"});n.add({title:"nos.unlink_desc",icon:"unlink",onclick:function(){j.editor.execCommand("unlink",false,"")},id:"unlink"});n.onShowMenu.add(function(q){var r=j.editor,v=r.selection.getNode(),u,t,s;u=d.getParent(v,"A");t=!!u;s=t&&!!u.name;q.items.link.setDisabled(s);q.items.link.setActive(t&&!s);q.items.unlink.setDisabled(!t)})});return m},_createFileButton:function(){var m,j=this,k=j.settings,l={},i;m=j.editor.controlManager.createButton("file",{title:"nos.file_title",label:"nos.file_label","class":"mce_file"});return m},_createToolbarToggle:function(){var q,w=this,x=w.settings,j={},r,m=w.editor,l=new Array(),u=["1","2","3"],k;for(k=0;k<u.length;k++){l[k]=m.getParam("","toolbar"+(u[k]).replace(" ",""))}q=w.editor.controlManager.createButton("toolbar_toggle",{title:"nos.toolbar_toggle_title",label:"nos.toolbar_toggle_label_open","class":"mce_toolbar_toggle_open",cmd:"mceToggleToolbars"});var p=function(o,i){if(x.theme_nos_toolbar_location==="external"){var s=d.get(o.id+"_external");$(s).css("top",($(s).position().top+i)+"px")}else{var t=o.getContentAreaContainer().firstChild;d.setStyle(t,"height",d.getSize(t).h+i);o.theme.deltaHeight+=i}},n=function(i){q.setActive(i);d.setAttrib(d.select(".mceIcon",q.id),"class","mceIcon");d.addClass(d.select(".mceIcon",q.id),i?"mce_toolbar_toggle_close":"mce_toolbar_toggle_open");d.setHTML(d.select(".mceButtonLabel",q.id),m.getLang(i?"nos.toolbar_toggle_label_close":"nos.toolbar_toggle_label_open",0))};m.addCommand("mceToggleToolbars",function(){var i=m.controlManager,z,v,o=e.util.Cookie,s,y=o.getHash("TinyMCE_toggle")||new Object(),t=0;for(v=0;v<l.length;v++){obj=m.controlManager.get(l[v]);if(typeof obj=="undefined"){continue}z=obj.id;if(d.isHidden(z)){s=1;d.show(z);t=t-26}else{s=0;d.hide(z);t=t+26}}p(m,t);n(s);y[m.id]=s;o.setHash("TinyMCE_toggle",y)});m.onPostRender.add(function(){var o=e.util.Cookie.getHash("TinyMCE_toggle")||new Object(),t=0,v=false;if(o[m.id]==null){v=true}else{if(o[m.id]==="0"){v=true}}if(v){var i=m.controlManager,s,y;for(k=0;k<u.length;k++){tbId=m.getParam("","toolbar"+(u[k]).replace(" ",""));y=m.controlManager.get(tbId).id;d.hide(y);t=t+26}p(m,t);n(0)}});return q},_createPaste:function(){var m,j=this,k=j.settings,l={},i;m=j.editor.controlManager.createSplitButton("paste",{title:"nos.paste_desc",cmd:"nosPaste","class":"mcePasteBouton"});m.onRenderMenu.add(function(o,n){n.add({title:"nos.paste_desc","class":"mceMenuItemTitle"}).setDisabled(1);n.add({title:"nos.paste_desc",icon:"paste",cmd:"nosPaste"});n.addSeparator();n.add({title:"paste.paste_text_desc",icon:"pastetext",onclick:function(){j.editor.execCommand("mcePasteText",true,"")}});n.add({title:"paste.paste_word_desc",icon:"pasteword",onclick:function(){j.editor.execCommand("mcePasteWord",true,"")}});n.add({title:"nos.paste_html_desc",icon:"pastehtml",onclick:function(){j.editor.execCommand("nosPasteHtml",true,"")}})});return m},_createEnhancer:function(){var m,j=this,k=j.settings,l={},i;if(!k.theme_nos_enhancers){return false}m=j.editor.controlManager.createMenuButton("enhancer",{title:"nos.enhancer_desc",label:"nos.enhancer_desc",cmd:"nosEnhancer"});m.onRenderMenu.add(function(o,n){n.settings.max_height=300;n.add({title:"nos.enhancer_desc","class":"mceMenuItemTitle"}).setDisabled(1);f(k.theme_nos_enhancers,function(p){n.add({title:p.title,style:"background: url("+p.iconUrl+") no-repeat 5px center;",id:"enhancer_"+p.id,onclick:function(){j.editor.execCommand("nosEnhancer",false,p)}})})});return m},_createVisualHtml:function(){var m,j=this,k=j.settings,l={},i;m=j.editor.controlManager.createButton("visualhtml",{title:"nos.visualthml_desc",icon:"visualhtml",onclick:function(){j.editor.execCommand("nosVisualHtml",false,"")}});return m},_createFontSelect:function(){var k,j=this,i=j.editor;k=i.controlManager.createListBox("fontselect",{title:"nos.fontdefault",onselect:function(l){var m=k.items[k.selectedIndex];if(!l&&m){i.execCommand("FontName",false,m.value);return}i.execCommand("FontName",false,l);k.select(function(n){return l==n});if(m&&m.value==l){k.select(null)}return false}});if(k){f(i.getParam("theme_nos_fonts",j.settings.theme_nos_fonts,"hash"),function(m,l){k.add(i.translate(l),m,{style:m.indexOf("dings")==-1?"font-family:"+m:""})})}return k},_createFontSizeSelect:function(){var m=this,k=m.editor,n,l=0,j=[];n=k.controlManager.createListBox("fontsizeselect",{title:"nos.font_size",onselect:function(i){var o=n.items[n.selectedIndex];if(!i&&o){o=o.value;if(o["class"]){k.formatter.toggle("fontsize_class",{value:o["class"]});k.undoManager.add();k.nodeChanged()}else{k.execCommand("FontSize",false,o.fontSize)}return}if(i["class"]){k.focus();k.undoManager.add();k.formatter.toggle("fontsize_class",{value:i["class"]});k.undoManager.add();k.nodeChanged()}else{k.execCommand("FontSize",false,i.fontSize)}n.select(function(p){return i==p});if(o&&(o.value.fontSize==i.fontSize||o.value["class"]&&o.value["class"]==i["class"])){n.select(null)}return false}});if(n){f(m.settings.theme_nos_font_sizes,function(o,i){var p=o.fontSize;if(p>=1&&p<=7){p=m.sizes[parseInt(p)-1]+"pt"}n.add(i,o,{style:"font-size:"+p,"class":"mceFontSize"+(l++)+(" "+(o["class"]||""))})})}return n},_createJustify:function(o){var l=this,j=l.editor,k=j.controlManager,m,i={justifyleft:{title:"nos.justifyleft_desc",cmd:"JustifyLeft"},justifycenter:{title:"nos.justifycenter_desc",cmd:"JustifyCenter"},justifyright:{title:"nos.justifyright_desc",cmd:"JustifyRight"},justifyfull:{title:"nos.justifyfull_desc",cmd:"JustifyFull"}};m=k.createListBox("justifycontrols",{title:"nos.justify_select",onselect:function(n){var p=i[n];j.execCommand(p.cmd,false);return false}},e.ui.NosListBox);j.onInit.add(function(){var n=0;f(i,function(q,p){m.add(q.title,p,e.extend(q,{icon:p}))})});return m},_createStyleSelect:function(o){var l=this,j=l.editor,k=j.controlManager,m;m=k.createListBox("styleselect",{title:"nos.style_select",onselect:function(p){var q,n=[];f(m.items,function(r){n.push(r.value)});j.focus();j.undoManager.add();q=j.formatter.matchAll(n);if(!p||q[0]==p){j.formatter.remove(q[0])}else{j.formatter.apply(p)}j.undoManager.add();j.nodeChanged();return false}});var i=j.getParam("theme_nos_style_formats",l.settings.theme_nos_style_formats);j.onInit.add(function(){var n=0;f(i,function(p){var q,r=0;f(p,function(){r++});if(r>1){q=p.name=p.name||"style_"+(n++);j.formatter.register(q,p);m.add(p.title,q)}else{m.add(p.title)}})});m.onRenderMenu.add(function(p,n){n.onShowMenu.add(function(){if(!n.updatestyle){var x=true,s=0,v,r,w,q=l.editor.getBody(),t=l.editor.dom.getStyle("tinymce","background-color",true);f(n.items,function(z,B){var y=i[s],A;A=d.select("#"+B);A=A[0];if(x){x=false;return}if(y.inline||y.block){r=l.editor.dom.add(q,y.inline?y.inline:y.block,{"class":y.classes,style:"display:none;"},"test"+y.title);w=d.select("span.mceText",A);f(["font-family","font-size","font-style","color","font-weight","font-variant","text-decoration","text-transformation"],function(C){v=l.editor.dom.getStyle(r,C,true);d.setStyle(w,C,v)});v=l.editor.dom.getStyle(r,"background-color",true);d.setStyle(A,"background-color",v=="transparent"?t:v);l.editor.dom.remove(r)}s++});n.updatestyle=true;var u=d.getRect("menu_"+n.id+"_tbl");d.setStyle("menu_"+n.id,"width",u.w);d.setStyle("menu_"+n.id+"_co","width",u.w);d.setStyle("menu_"+n.id+"_co","overflow-y","auto")}})});return m},_createBlockFormats:function(){var m,i={p:"nos.paragraph",address:"nos.address",pre:"nos.pre",h1:"nos.h1",h2:"nos.h2",h3:"nos.h3",h4:"nos.h4",h5:"nos.h5",h6:"nos.h6",div:"nos.div",blockquote:"nos.blockquote",code:"nos.code",dt:"nos.dt",dd:"nos.dd",samp:"nos.samp"},k=this,j,l;m=k.editor.controlManager.createListBox("formatselect",{title:"nos.block",cmd:"FormatBlock"});if(m){fmts_site=k.editor.getParam("theme_nos_blockformats",k.settings.theme_nos_blockformats,"hash");f(fmts_site,function(o,n){m.add(k.editor.translate(n!=o?n:i[o]),o,{"class":"mce_formatPreview mce_"+o})});m.onRenderMenu.add(function(o,n){n.onShowMenu.add(function(){var q;if(!n.updatestyle){l=k.editor.dom.getStyle("tinymce","background-color",true);f(fmts_site,function(s,r){co=k.editor.getBody();co=co.insertBefore(k.editor.dom.create(s,{id:"fake_"+s,style:"display:none;"},"test"+s),co.firstChild);f(["font-family","font-size","font-style","color","font-weight","font-variant","text-decoration","text-transformation"],function(t){q=k.editor.dom.getStyle("fake_"+s,t,true);d.setStyle(d.select(".mce_"+s+" span.mceText"),t,q)});q=k.editor.dom.getStyle("fake_"+s,"background-color",true);d.setStyle(d.select(".mce_"+s),"background-color",q=="transparent"?l:q);k.editor.dom.remove("fake_"+s)});n.updatestyle=true}var p;p=d.getRect("menu_"+n.id+"_tbl");d.setStyle("menu_"+n.id,"width",p.w);d.setStyle("menu_"+n.id,"height",p.h);d.setStyle("menu_"+n.id+"_co","width",p.w);d.setStyle("menu_"+n.id+"_co","height",p.h)})})}return m},_createForeColorMenu:function(){var m,j=this,k=j.settings,l={},i;if(k.theme_nos_more_colors){l.more_colors_func=function(){j._mceColorPicker(0,{color:m.value,func:function(n){m.setColor(n)}})}}if(i=k.theme_nos_text_colors){l.colors=i}if(k.theme_nos_default_foreground_color){l.default_color=k.theme_nos_default_foreground_color}l.title="nos.forecolor_desc";l.cmd="ForeColor";l.scope=this;m=j.editor.controlManager.createColorSplitButton("forecolor",l);return m},_createBackColorMenu:function(){var m,j=this,k=j.settings,l={},i;if(k.theme_nos_more_colors){l.more_colors_func=function(){j._mceColorPicker(0,{color:m.value,func:function(n){m.setColor(n)}})}}if(i=k.theme_nos_background_colors){l.colors=i}if(k.theme_nos_default_background_color){l.default_color=k.theme_nos_default_background_color}l.title="nos.backcolor_desc";l.cmd="HiliteColor";l.scope=this;m=j.editor.controlManager.createColorSplitButton("backcolor",l);return m},renderUI:function(k){var m,l,q,v=this,r=v.editor,w=v.settings,u,j,i;if(r.settings){r.settings.aria_label=w.aria_label+r.getLang("nos.help_shortcut")}m=j=d.create("span",{role:"application","aria-labelledby":r.id+"_voice",id:r.id+"_parent","class":"mceEditor "+r.settings.skin+"Skin"+(w.skin_variant?" "+r.settings.skin+"Skin"+v._ufirst(w.skin_variant):"")});d.add(m,"span",{"class":"mceVoiceLabel",style:"display:none;",id:r.id+"_voice"},w.aria_label);if(!d.boxModel){m=d.add(m,"div",{"class":"mceOldBoxModel"})}m=u=d.add(m,"table",{role:"presentation",id:r.id+"_tbl","class":"mceLayout",cellSpacing:0,cellPadding:0});m=q=d.add(m,"tbody");switch((w.theme_nos_layout_manager||"").toLowerCase()){case"rowlayout":l=v._rowLayout(w,q,k);break;case"customlayout":l=r.execCallback("theme_nos_custom_layout",w,q,k,j);break;default:l=v._simpleLayout(w,q,k,j)}m=k.targetNode;i=u.rows;d.addClass(i[0],"mceFirst");d.addClass(i[i.length-1],"mceLast");f(d.select("tr",q),function(o){d.addClass(o.firstChild,"mceFirst");d.addClass(o.childNodes[o.childNodes.length-1],"mceLast")});if(d.get(w.theme_nos_toolbar_container)){d.get(w.theme_nos_toolbar_container).appendChild(j)}else{d.insertAfter(j,m)}b.add(r.id+"_path_row","click",function(n){n=n.target;if(n.nodeName=="A"){v._sel(n.className.replace(/^.*mcePath_([0-9]+).*$/,"$1"));return b.cancel(n)}});if(!r.getParam("accessibility_focus")){b.add(d.add(j,"a",{href:"#"},"<!-- IE -->"),"focus",function(){tinyMCE.get(r.id).focus()})}if(w.theme_nos_toolbar_location=="external"){k.deltaHeight=0}v.deltaHeight=k.deltaHeight;k.targetNode=null;r.onKeyDown.add(function(p,n){var s=121,o=122;if(n.altKey){if(n.keyCode===s){if(e.isWebKit){window.focus()}v.toolbarGroup.focus();return b.cancel(n)}else{if(n.keyCode===o){d.get(p.id+"_path_row").focus();return b.cancel(n)}}}});r.addShortcut("alt+0","","mceShortcuts",v);return{iframeContainer:l,editorContainer:r.id+"_parent",sizeContainer:u,deltaHeight:k.deltaHeight}},getInfo:function(){return{longname:"Nos theme",author:"Novius-OS",authorurl:"http://www.novius-os.org",version:"0.1"}},resizeBy:function(i,j){var k=d.get(this.editor.id+"_ifr");this.resizeTo(k.clientWidth+i,k.clientHeight+j)},resizeTo:function(i,m,k){var j=this.editor,l=this.settings,n=d.get(j.id+"_tbl"),o=d.get(j.id+"_ifr");i=Math.max(l.theme_nos_resizing_min_width||100,i);m=Math.max(l.theme_nos_resizing_min_height||100,m);i=Math.min(l.theme_nos_resizing_max_width||65535,i);m=Math.min(l.theme_nos_resizing_max_height||65535,m);d.setStyle(n,"height","");d.setStyle(o,"height",m);if(l.theme_nos_resize_horizontal){d.setStyle(n,"width","");d.setStyle(o,"width",i);if(i<n.clientWidth){i=n.clientWidth;d.setStyle(o,"width",n.clientWidth)}}if(k&&l.theme_nos_resizing_use_cookie){a.setHash("TinyMCE_"+j.id+"_size",{cw:i,ch:m})}},destroy:function(){var i=this.editor.id;b.clear(i+"_resize");b.clear(i+"_path_row");b.clear(i+"_external_close")},_simpleLayout:function(y,r,k,i){var x=this,u=x.editor,v=y.theme_nos_toolbar_location,m=y.theme_nos_statusbar_location,l,j,q,w;if(y.readonly){l=d.add(r,"tr");l=j=d.add(l,"td",{"class":"mceIframeContainer"});return j}if(v=="top"){x._addToolbars(r,k)}if(v=="external"){l=w=d.create("div",{style:"position:relative"});l=d.add(l,"div",{id:u.id+"_external","class":"mceExternalToolbar"});d.add(l,"a",{id:u.id+"_external_close",href:"javascript:;","class":"mceExternalClose"});l=d.add(l,"table",{id:u.id+"_tblext",cellSpacing:0,cellPadding:0});q=d.add(l,"tbody");if(i.firstChild.className=="mceOldBoxModel"){i.firstChild.appendChild(w)}else{i.insertBefore(w,i.firstChild)}x._addToolbars(q,k);u.onMouseUp.add(function(){var p=d.get(u.id+"_external");d.show(p);d.hide(g);var o=b.add(u.id+"_external_close","click",function(){d.hide(u.id+"_external");b.remove(u.id+"_external_close","click",o)});d.show(p);var n=d.getRect(u.id+"_tblext");d.setStyle(p,"top",0-n.h-1);if(n.w+n.x>window.innerWidth){d.setStyle(p,"left",window.innerWidth-n.w-n.x-1)}d.hide(p);d.show(p);p.style.filter="";g=u.id+"_external";p=null})}if(m=="top"){x._addStatusBar(r,k)}if(!y.theme_nos_toolbar_container){l=d.add(r,"tr");l=j=d.add(l,"td",{"class":"mceIframeContainer"})}if(v=="bottom"){x._addToolbars(r,k)}if(m=="bottom"){x._addStatusBar(r,k)}return j},_rowLayout:function(w,m,k){var v=this,p=v.editor,u,x,i=p.controlManager,l,j,r,q;u=w.theme_nos_containers_default_class||"";x=w.theme_nos_containers_default_align||"center";f(c(w.theme_nos_containers||""),function(s,o){var n=w["theme_nos_container_"+s]||"";switch(s.toLowerCase()){case"mceeditor":l=d.add(m,"tr");l=j=d.add(l,"td",{"class":"mceIframeContainer"});break;case"mceelementpath":v._addStatusBar(m,k);break;default:q=(w["theme_nos_container_"+s+"_align"]||x).toLowerCase();q="mce"+v._ufirst(q);l=d.add(d.add(m,"tr"),"td",{"class":"mceToolbar "+(w["theme_nos_container_"+s+"_class"]||u)+" "+q||x});r=i.createToolbar("toolbar"+o);v._addControls(n,r);d.setHTML(l,r.renderHTML());k.deltaHeight-=w.theme_nos_row_height}});return j},_addControls:function(j,i){var k=this,l=k.settings,m,n=k.editor.controlManager;if(l.theme_nos_disable&&!k._disabled){m={};f(c(l.theme_nos_disable),function(o){m[o]=1});k._disabled=m}else{m=k._disabled}f(c(j),function(p){var o;if(m&&m[p]){return}if(p=="tablecontrols"){f(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(q){q=k.createControl(q,n);if(q){i.add(q)}});return}o=k.createControl(p,n);if(o){i.add(o)}})},_addToolbars:function(x,k){var A=this,p,m,r=A.editor,B=A.settings,z,j=r.controlManager,u,l,q=[],y,w;w=j.createToolbarGroup("toolbargroup",{name:r.getLang("nos.toolbar"),tab_focus_toolbar:r.getParam("theme_nos_tab_focus_toolbar")});A.toolbarGroup=w;y=B.theme_nos_toolbar_align.toLowerCase();y="mce"+A._ufirst(y);l=d.add(d.add(x,"tr",{role:"presentation"}),"td",{"class":"mceToolbar "+y,role:"presentation"});for(p=1;(z=B["theme_nos_buttons"+p]);p++){m=j.createToolbar("toolbar"+p,{"class":"mceToolbarRow"+p});if(B["theme_nos_buttons"+p+"_add"]){z+=","+B["theme_nos_buttons"+p+"_add"]}if(B["theme_nos_buttons"+p+"_add_before"]){z=B["theme_nos_buttons"+p+"_add_before"]+","+z}A._addControls(z,m);w.add(m);k.deltaHeight-=B.theme_nos_row_height}q.push(w.renderHTML());q.push(d.createHTML("a",{href:"#",accesskey:"z",title:r.getLang("nos.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+r.id+"').focus();"},"<!-- IE -->"));d.setHTML(l,q.join(""))},_addStatusBar:function(m,j){var k,v=this,p=v.editor,w=v.settings,i,q,u,l;k=d.add(m,"tr");k=l=d.add(k,"td",{"class":"mceStatusbar"});k=d.add(k,"div",{id:p.id+"_path_row",role:"group","aria-labelledby":p.id+"_path_voice"});if(w.theme_nos_path){d.add(k,"span",{id:p.id+"_path_voice"},p.translate("nos.path"));d.add(k,"span",{},": ")}else{d.add(k,"span",{},"&#160;")}if(w.theme_nos_resizing){d.add(l,"a",{id:p.id+"_resize",href:"javascript:;",onclick:"return false;","class":"mceResize",tabIndex:"-1"});if(w.theme_nos_resizing_use_cookie){p.onPostRender.add(function(){var n=a.getHash("TinyMCE_"+p.id+"_size"),r=d.get(p.id+"_tbl");if(!n){return}v.resizeTo(n.cw,n.ch)})}p.onPostRender.add(function(){b.add(p.id+"_resize","click",function(n){n.preventDefault()});b.add(p.id+"_resize","mousedown",function(D){var t,r,s,o,C,z,A,F,n,E,x;function y(G){G.preventDefault();n=A+(G.screenX-C);E=F+(G.screenY-z);v.resizeTo(n,E)}function B(G){b.remove(d.doc,"mousemove",t);b.remove(p.getDoc(),"mousemove",r);b.remove(d.doc,"mouseup",s);b.remove(p.getDoc(),"mouseup",o);n=A+(G.screenX-C);E=F+(G.screenY-z);v.resizeTo(n,E,true)}D.preventDefault();C=D.screenX;z=D.screenY;x=d.get(v.editor.id+"_ifr");A=n=x.clientWidth;F=E=x.clientHeight;t=b.add(d.doc,"mousemove",y);r=b.add(p.getDoc(),"mousemove",y);s=b.add(d.doc,"mouseup",B);o=b.add(p.getDoc(),"mouseup",B)})})}j.deltaHeight-=21;k=m=null},_updateUndoStatus:function(j){var i=j.controlManager,k=j.undoManager;i.setDisabled("undo",!k.hasUndo()&&!k.typing);i.setDisabled("redo",!k.hasRedo())},_nodeChanged:function(m,r,D,q,E){var y=this,C,F=0,x,G,z=y.settings,w,k,u,B,l,j,i;e.each(y.stateControls,function(n){r.setActive(n,m.queryCommandState(y.controls[n][1]))});function o(p){var s,n=E.parents,t=p;if(typeof(p)=="string"){t=function(v){return v.nodeName==p}}for(s=0;s<n.length;s++){if(t(n[s])){return n[s]}}}y._updateUndoStatus(m);r.setDisabled("outdent",!m.queryCommandState("Outdent"));r.setActive("visualhtml",!(m.dom.select("body.debug")==""));C=o("A");if(G=r.get("linkcontrols")){G.setDisabled(q);G.setActive(!!C)}if(G=r.get("anchor")){G.setActive(!q&&!!C&&C.name)}C=o("IMG");if(G=r.get("image")){G.setActive(!q&&!!C&&D.className.indexOf("mceItem")==-1)}if(G=r.get("styleselect")){G.showMenu();G.hideMenu();m.focus();j=[];f(G.items,function(n){j.push(n.value)});i=m.formatter.matchAll(j);G.select(i[0])}if(G=r.get("justifycontrols")){f(G.items,function(p,n){if(m.queryCommandState(p.cmd)){G.selectByIndex(n)}})}if(G=r.get("formatselect")){C=o(d.isBlock);if(C){G.select(C.nodeName.toLowerCase())}}o(function(p){if(p.nodeName==="SPAN"){if(!w&&p.className){w=p.className}}if(m.dom.is(p,z.theme_nos_font_selector)){if(!k&&p.style.fontSize){k=p.style.fontSize}if(!u&&p.style.fontFamily){u=p.style.fontFamily.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()}if(!B&&p.style.color){B=p.style.color}if(!l&&p.style.backgroundColor){l=p.style.backgroundColor}}return false});if(G=r.get("fontselect")){G.select(function(n){return n.replace(/^([^,]+).*/,"$1").toLowerCase()==u})}if(G=r.get("fontsizeselect")){if(z.theme_nos_runtime_fontsize&&!k&&!w){k=m.dom.getStyle(D,"fontSize",true)}G.select(function(n){if(n.fontSize&&n.fontSize===k){return true}if(n["class"]&&n["class"]===w){return true}})}if(z.theme_nos_show_current_color){function A(p,n){if(G=r.get(p)){if(!n){n=G.settings.default_color}if(n!==G.value){G.displayColor(n)}}}A("forecolor",B);A("backcolor",l)}if(z.theme_nos_show_current_color){function A(p,n){if(G=r.get(p)){if(!n){n=G.settings.default_color}if(n!==G.value){G.displayColor(n)}}}A("forecolor",B);A("backcolor",l)}if(z.theme_nos_path&&z.theme_nos_statusbar_location){C=d.get(m.id+"_path")||d.add(m.id+"_path_row","span",{id:m.id+"_path"});if(y.statusKeyboardNavigation){y.statusKeyboardNavigation.destroy();y.statusKeyboardNavigation=null}d.setHTML(C,"");o(function(H){var p=H.nodeName.toLowerCase(),s,v,t="";if(H.nodeType!=1||p==="br"||H.getAttribute("data-mce-bogus")||d.hasClass(H,"mceItemHidden")||d.hasClass(H,"mceItemRemoved")){return}if(e.isIE&&H.scopeName!=="HTML"){p=H.scopeName+":"+p}p=p.replace(/mce\:/g,"");switch(p){case"b":p="strong";break;case"i":p="em";break;case"img":if(x=d.getAttrib(H,"src")){t+="src: "+x+" "}break;case"a":if(x=d.getAttrib(H,"name")){t+="name: "+x+" ";p+="#"+x}if(x=d.getAttrib(H,"href")){t+="href: "+x+" "}break;case"font":if(x=d.getAttrib(H,"face")){t+="font: "+x+" "}if(x=d.getAttrib(H,"size")){t+="size: "+x+" "}if(x=d.getAttrib(H,"color")){t+="color: "+x+" "}break;case"span":if(x=d.getAttrib(H,"style")){t+="style: "+x+" "}break}if(x=d.getAttrib(H,"id")){t+="id: "+x+" "}if(x=H.className){x=x.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,"");if(x){t+="class: "+x+" ";if(d.isBlock(H)||p=="img"||p=="span"){p+="."+x}}}p=p.replace(/(html:)/g,"");p={name:p,node:H,title:t};y.onResolveName.dispatch(y,p);t=p.title;p=p.name;v=d.create("a",{href:"javascript:;",role:"button",onmousedown:"return false;",title:t,"class":"mcePath_"+(F++)},p);if(C.hasChildNodes()){C.insertBefore(d.create("span",{"aria-hidden":"true"},"\u00a0\u00bb "),C.firstChild);C.insertBefore(v,C.firstChild)}else{C.appendChild(v)}},m.getBody());if(d.select("a",C).length>0){y.statusKeyboardNavigation=new e.ui.KeyboardNavigation({root:m.id+"_path_row",items:d.select("a",C),excludeFromTabOrder:true,onCancel:function(){m.focus()}},d)}}},_sel:function(i){this.editor.execCommand("mceSelectNodeDepth",false,i)},_mceInsertAnchor:function(k,j){var i=this.editor;i.windowManager.open({url:this.url+"/anchor.htm",width:320+parseInt(i.getLang("nos.anchor_delta_width",0)),height:90+parseInt(i.getLang("nos.anchor_delta_height",0)),inline:true},{theme_url:this.url})},_mceCharMap:function(){var i=this.editor;i.windowManager.open({url:this.url+"/charmap.htm",width:550+parseInt(i.getLang("nos.charmap_delta_width",0)),height:250+parseInt(i.getLang("nos.charmap_delta_height",0)),inline:true},{theme_url:this.url})},_mceColorPicker:function(k,j){var i=this.editor;j=j||{};i.windowManager.open({url:this.url+"/color_picker.htm",width:375+parseInt(i.getLang("nos.colorpicker_delta_width",0)),height:250+parseInt(i.getLang("nos.colorpicker_delta_height",0)),close_previous:false,inline:true},{input_color:j.color,func:j.func,theme_url:this.url})},_mceCodeEditor:function(j,k){var i=this.editor;i.windowManager.open({url:this.url+"/source_editor.htm",width:parseInt(i.getParam("theme_nos_source_editor_width",720)),height:parseInt(i.getParam("theme_nos_source_editor_height",580)),inline:true,resizable:true,maximizable:true},{theme_url:this.url})},_mceLink:function(j,k){var i=this.editor;i.windowManager.open({url:this.url+"/link.htm",width:310+parseInt(i.getLang("nos.link_delta_width",0)),height:200+parseInt(i.getLang("nos.link_delta_height",0)),inline:true},{theme_url:this.url})},_mceNewDocument:function(){var i=this.editor;i.windowManager.confirm("nos.newdocument",function(j){if(j){i.execCommand("mceSetContent",false,"")}})},_mceForeColor:function(){var i=this;this._mceColorPicker(0,{color:i.fgColor,func:function(j){i.fgColor=j;i.editor.execCommand("ForeColor",false,j)}})},_mceBackColor:function(){var i=this;this._mceColorPicker(0,{color:i.bgColor,func:function(j){i.bgColor=j;i.editor.execCommand("HiliteColor",false,j)}})},_nosPasteHtml:function(j,k){var i=this.editor;i.windowManager.open({url:this.url+"/pastehtml.htm",width:600,height:420,inline:true},{theme_url:this.url})},_nosBrClearAll:function(j,k){var i=this.editor;br='<br style="clear: both"/>';i.execCommand("mceInsertContent",false,br)},_nosVisualHtml:function(j,k){var i=this.editor;if((i.dom.select("body.debug")=="")){i.dom.addClass(i.dom.select("body"),"debug")}else{i.dom.removeClass(i.dom.select("body"),"debug")}},_nosEnhancer:function(o,p,q){var l=tinyMCE.activeEditor;var n=null;var r=this;var m=function(s){var u=$(s.preview);u.attr({id:"__mce_tmp","data-config":s.config,"data-enhancer":p.id}).addClass("mceNonEditable");if(q){q.empty().removeClass("mceNonEditable nosEnhancer").data("config","").data("enhancer","");l.selection.select(q.get(0),true);l.focus(false);l.execCommand("mceSelectNode",false,q.get(0),{skip_undo:1});l.execCommand("mceReplaceContent",false,$("<div></div>").append(u).html(),{skip_undo:1})}else{l.execCommand("mceInsertContent",false,$("<div></div>").append(u).html(),{skip_undo:1})}var t=$(l.dom.get("__mce_tmp"));t.attr("id","");r.onEnhancerAdd(t,p);l.selection.select(t.get(0),true);l.selection.collapse(true);l.focus(false);l.execCommand("mceSelectNode",false,t.get(0),{skip_undo:1});l.execCommand("mceStartTyping");l.execCommand("mceEndUndoLevel")};if(!$.isPlainObject(p.dialog)||!p.dialog.contentUrl){$.ajax({url:p.previewUrl,type:"POST",dataType:"json",success:m,error:function(){console.log("Error: unable to add the enhancer in the Wysiwyg (no popup)")}});return}if(p.dialog.ajax||!q){n=$(l.formElement).nos().dialog($.extend({title:p.title},q?$.extend({},p.dialog,{ajax:q.data("config")}):p.dialog))}else{n=$(l.formElement).nos().dialog($.extend({title:p.title},$.extend({},p.dialog,{contentUrl:null})));var j=$("<form></form>").attr("action",p.dialog.contentUrl).attr("method","post").attr("target","tinymce_dialog").appendTo(n),k=$("<iframe></iframe>").attr("src",/^https/i.test(window.location.href||"")?"javascript:false":"about:blank").attr("frameborder","0").attr("name","tinymce_dialog").css({width:"100%",height:"99%"}).appendTo(n),i=function(s,t){if($.isArray(t)){$.each(t,function(u,v){i(s+"[]",v)})}else{$('<input type="hidden" name="'+s+'">').attr("value",t).appendTo(j)}};$.each(q.data("config")||{},function(s,t){i(s,t)});n.css("padding","0px");j.submit()}n.bind("save.enhancer",function(t,s){m(s);n.dialog("close")})},_nosImage:function(k,m){var i=this.editor;if(i.dom.getAttrib(i.selection.getNode(),"class").indexOf("mceItem")!=-1){return}var l=i.selection.getNode().nodeName=="IMG";var j=null;j=$(i.formElement).nos().dialog({contentUrl:"admin/nos/wysiwyg/image"+(l?"/edit":""),title:l?i.getLang("nos.image_edit"):i.getLang("nos.image_insert"),ajax:true,open:function(n){$(n.target).data("tinymce",i)}});j.bind("insert.media",function(p,n){j.dialog("close");var o=$("<div></div>").append($(n).addClass("nosMedia")).html();if(l){i.execCommand("mceReplaceContent",false,o,{skip_undo:1})}else{i.execCommand("mceInsertContent",false,o,{skip_undo:1})}i.execCommand("mceEndUndoLevel")})},onEnhancerAdd:function(i,n){var j=tinyMCE.activeEditor;i=$(i);var m=$('<a href="#" data-action="removeEnhancer">Delete</a>').attr("title",j.getLang("nos.enhancer_delete")).addClass("nos_enhancer_action nos_enhancer_action_delete"),l=$('<a href="#" data-action="editEnhancer">Options</a>').attr("title",j.getLang("nos.enhancer_options")).addClass("nos_enhancer_action nos_enhancer_action_edit"),o=$('<a href="#" data-action="addParagraphAfter">New paragraph after</a>').attr("title",j.getLang("nos.enhancer_p_after")).addClass("nos_enhancer_action nos_enhancer_action_after"),k=$('<a href="#" data-action="addParagraphBefore">New paragraph before</a>').attr("title",j.getLang("nos.enhancer_p_before")).addClass("nos_enhancer_action nos_enhancer_action_before");if(i.is("span")){i.addClass("nosEnhancerInline");i.append(document.createTextNode(" "));if($.isPlainObject(n.dialog)&&n.dialog.contentUrl){i.append(l)}i.append(m);i.before($("<span> </span>"));i.after($("<span> </span>"))}else{i.addClass("nosEnhancer");i.prepend(o.addClass("nos_enhancer_action_block"));i.prepend(k.addClass("nos_enhancer_action_block"));if($.isPlainObject(n.dialog)&&n.dialog.contentUrl){i.prepend(l.addClass("nos_enhancer_action_block"))}i.prepend(m.addClass("nos_enhancer_action_block"))}},_ufirst:function(i){return i.substring(0,1).toUpperCase()+i.substring(1)}});e.ThemeManager.add("nos",e.themes.NosTheme)}(tinymce));(function(c){var b=c.DOM,a=c.dom.Event,d=c.each;c.create("tinymce.ui.NosSplitButton:tinymce.ui.SplitButton",{NosSplitButton:function(g,f,e){this.parent(g,f,e);this.classPrefix="mceSplitButton";f.label=e.translate(f.label)},renderHTML:function(){var k=this.classPrefix,j=this.settings,i,e,g=this,f;e=b.encode(j.label||"");i="<tbody><tr>";if(j.image){f=b.createHTML("img ",{src:j.image,role:"presentation","class":"mceAction "+j["class"]})+e}else{f=b.createHTML("span",{"class":"mceAction "+j["class"]},"")}f+=(e?'<span class="'+k+'Label">'+e+"</span>":"");f+=b.createHTML("span",{"class":"mceVoiceLabel mceIconOnly",id:g.id+"_voice",style:"display:none;"},j.title);i+="<td >"+b.createHTML("a",{role:"button",id:g.id+"_action",tabindex:"-1",href:"javascript:;","class":"nosActionLabel mceAction "+(e?" "+k+"Labeled":"")+" "+j["class"],onclick:"return false;",onmousedown:"return false;",title:j.title},f)+"</td>";f=b.createHTML("span",{"class":"mceOpen "+j["class"]},'<span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25BC</span>');i+="<td >"+b.createHTML("a",{role:"button",id:g.id+"_open",tabindex:"-1",href:"javascript:;","class":"mceOpen "+j["class"],onclick:"return false;",onmousedown:"return false;",title:j.title},f)+"</td>";i+="</tr></tbody>";i=b.createHTML("table",{role:"presentation","class":"mceSplitButton mceSplitButtonEnabled "+j["class"],cellpadding:"0",cellspacing:"0",title:j.title},i);return b.createHTML("div",{id:g.id,role:"button",tabindex:"0","aria-labelledby":g.id+"_voice","aria-haspopup":"true"},i)}})})(tinymce);(function(c){var b=c.DOM,a=c.dom.Event,d=c.each;c.create("tinymce.ui.NosListBox:tinymce.ui.ListBox",{NosListBox:function(g,f,e){this.parent(g,f,e)},renderMenu:function(){var f=this,e;e=f.settings.control_manager.createDropMenu(f.id+"_menu",{menu_line:1,"class":f.classPrefix+"Menu",max_width:150,max_height:150});e.onHideMenu.add(function(){f.hideMenu();f.focus()});e.add({title:f.settings.title,"class":"mceMenuItemTitle",onclick:function(){if(f.settings.onselect("")!==false){f.select("")}}});d(f.items,function(g){if(g.value===undefined){e.add({title:g.title,role:"option","class":"mceMenuItemTitle",onclick:function(){if(f.settings.onselect("")!==false){f.select("")}}})}else{g.id=b.uniqueId();g.role="option";g.onclick=function(){if(f.settings.onselect(g.value)!==false){f.select(g.value)}};e.add(g)}});f.onRenderMenu.dispatch(f,e);f.menu=e}})})(tinymce);